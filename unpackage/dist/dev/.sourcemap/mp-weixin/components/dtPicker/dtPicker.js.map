{"version":3,"file":"dtPicker.js","sources":["components/dtPicker/dtPicker.vue","../../../soft/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovcHJvL3VuaXByby91bmlhcHBfc3R1ZHkvY29tcG9uZW50cy9kdFBpY2tlci9kdFBpY2tlci52dWU"],"sourcesContent":["<template>\r\n\t<view>\r\n\t\t<picker mode=\"multiSelector\" @change=\"doChange\" @columnchange=\"doColumnChange\" :value=\"self_value\" :range=\"self_range\">\r\n\t\t\t<input :disabled=\"true\" placeholder-style=\"color:#bbbbbb\" :placeholder=\"placeholder\" :value=\"value_text\" />\r\n\t\t</picker>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\treactive,\r\n\t\tonBeforeMount,\r\n\t\tdefineProps,\r\n\t\tdefineEmits,\r\n\t\ttoRaw,\r\n\t\twatch\r\n\t} from 'vue'\r\n\tconst props = defineProps({\r\n\t\ttimestamp: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0\r\n\t\t},\r\n\t\temptyText: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tplaceholder: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t}\r\n\t})\r\n\tconst emit = defineEmits(['dtPickerChanged'])\r\n\t// 当前时间\r\n\tconst now = new Date().getTime()\r\n\tconst self_range = ref([])\r\n\tlet self_days = null\r\n\tlet self_days_text = ''\r\n\tlet self_hours = null\r\n\tlet self_seconds = null\r\n\tconst self_value = ref([0, 0, 0])\r\n\tconst value_text = ref()\r\n\tonBeforeMount(() => {\r\n\t\tconst days = ['']\r\n\t\tconst days_text = [props.emptyText]\r\n\t\tfor (let i = 0; i < 20; i++) {\r\n\t\t\tdays.push(TIME_FORMAT(now + 86400000 * i, 'YYYY-MM-dd'));\r\n\t\t\tlet text = TIME_FORMAT(now + 86400000 * i, 'M月d日');\r\n\t\t\tif (i == 0) {\r\n\t\t\t\ttext += ' （今天）';\r\n\t\t\t}\r\n\t\t\tif (i == 1) {\r\n\t\t\t\ttext += ' （明天）';\r\n\t\t\t}\r\n\t\t\tif (i == 2) {\r\n\t\t\t\ttext += ' （后天）';\r\n\t\t\t}\r\n\t\t\tdays_text.push(text);\r\n\t\t\tconst hours = ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14',\r\n\t\t\t\t'15', '16', '17', '18', '19', '20', '21', '22', '23'\r\n\t\t\t];\r\n\t\t\tconst seconds = [\r\n\t\t\t\t'00',\r\n\t\t\t\t'01',\r\n\t\t\t\t'02',\r\n\t\t\t\t'03',\r\n\t\t\t\t'04',\r\n\t\t\t\t'05',\r\n\t\t\t\t'06',\r\n\t\t\t\t'07',\r\n\t\t\t\t'08',\r\n\t\t\t\t'09',\r\n\t\t\t\t'10',\r\n\t\t\t\t'11',\r\n\t\t\t\t'12',\r\n\t\t\t\t'13',\r\n\t\t\t\t'14',\r\n\t\t\t\t'15',\r\n\t\t\t\t'16',\r\n\t\t\t\t'17',\r\n\t\t\t\t'18',\r\n\t\t\t\t'19',\r\n\t\t\t\t'20',\r\n\t\t\t\t'21',\r\n\t\t\t\t'22',\r\n\t\t\t\t'23',\r\n\t\t\t\t'24',\r\n\t\t\t\t'25',\r\n\t\t\t\t'26',\r\n\t\t\t\t'27',\r\n\t\t\t\t'28',\r\n\t\t\t\t'29',\r\n\t\t\t\t'30',\r\n\t\t\t\t'31',\r\n\t\t\t\t'32',\r\n\t\t\t\t'33',\r\n\t\t\t\t'34',\r\n\t\t\t\t'35',\r\n\t\t\t\t'36',\r\n\t\t\t\t'37',\r\n\t\t\t\t'38',\r\n\t\t\t\t'39',\r\n\t\t\t\t'40',\r\n\t\t\t\t'41',\r\n\t\t\t\t'42',\r\n\t\t\t\t'43',\r\n\t\t\t\t'44',\r\n\t\t\t\t'45',\r\n\t\t\t\t'46',\r\n\t\t\t\t'47',\r\n\t\t\t\t'48',\r\n\t\t\t\t'49',\r\n\t\t\t\t'50',\r\n\t\t\t\t'51',\r\n\t\t\t\t'52',\r\n\t\t\t\t'53',\r\n\t\t\t\t'54',\r\n\t\t\t\t'55',\r\n\t\t\t\t'56',\r\n\t\t\t\t'57',\r\n\t\t\t\t'58',\r\n\t\t\t\t'59'\r\n\t\t\t];\r\n\t\t\tconst range = [];\r\n\t\t\trange[0] = days_text;\r\n\t\t\trange[1] = hours;\r\n\t\t\trange[2] = seconds;\r\n\t\t\tself_range.value = range\r\n\t\t\tself_days = days\r\n\t\t\tself_days_text = days_text\r\n\t\t\tself_hours = hours\r\n\t\t\tself_seconds = seconds\r\n\t\t}\r\n\t})\r\n\tconst doChange = () => {\r\n\t\tvalue_text.value = getValueText()\r\n\t\tvar day = self_days[self_value.value[0]];\r\n\t\tvar hour = self_hours[self_value.value[1]];\r\n\t\tvar second = self_seconds[self_value.value[2]];\r\n\t\tvar datetime = '';\r\n\t\tif (day) {\r\n\t\t\tdatetime = day + ' ' + hour + ':' + second;\r\n\t\t}\r\n\t\tvar timestamp = 0;\r\n\t\tif (datetime) {\r\n\t\t\ttimestamp = new Date(datetime.replace(/-/g, '/')).getTime();\r\n\t\t}\r\n\r\n\t\temit('dtPickerChanged', {\r\n\t\t\tdetail: {\r\n\t\t\t\tvalue: timestamp\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\tconst doColumnChange = (e) => {\r\n\t\tvar value = self_value.value;\r\n\t\tvalue[e.detail.column] = e.detail.value;\r\n\t\tself_value.value = value\r\n\t}\r\n\tconst TIME_FORMAT = (t, fmt) => {\r\n\t\tconst newDate = new Date();\r\n\t\tnewDate.setTime(t);\r\n\t\treturn newDate.VP_FORMAT(fmt);\r\n\t}\r\n\tconst timestampChange = (timestamp) => {\r\n\t\t// 未初始化时不执行\r\n\t\tif (!self_days) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (timestamp > 0) {\r\n\t\t\tvar days = self_days;\r\n\t\t\tvar days_text = self_days_text;\r\n\t\t\tvar hours = self_hours;\r\n\t\t\tvar seconds = self_seconds;\r\n\t\t}\r\n\t\tif (timestamp < now) {\r\n\t\t\ttimestamp = now;\r\n\t\t}\r\n\t\tvar date = TIME_FORMAT(timestamp, 'YYYY-MM-dd');\r\n\t\tvar hour = TIME_FORMAT(timestamp, 'hh');\r\n\t\tvar minutes = TIME_FORMAT(timestamp, 'mm');\r\n\t\tvar value = toRaw(self_value.value)\r\n\t\tfor (var i = 0; i < days.length; i++) {\r\n\t\t\tif (date == days[i]) {\r\n\t\t\t\tvalue[0] = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < hours.length; i++) {\r\n\t\t\tif (hour == hours[i]) {\r\n\t\t\t\tvalue[1] = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// console.log('VP---D>'+value[1]);\r\n\t\tfor (var i = 0; i < seconds.length; i++) {\r\n\t\t\tif (minutes == seconds[i]) {\r\n\t\t\t\tvalue[2] = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tself_value.value = value\r\n\t\tvalue_text.value = getValueText()\r\n\t}\r\n\tconst getValueText = () => {\r\n\t\tvar day = self_days_text[self_value.value[0]];\r\n\t\tvar hour = self_hours[self_value.value[1]];\r\n\t\tvar second = self_seconds[self_value.value[2]];\r\n\t\tif (self_days[self_value.value[0]] == '') {\r\n\t\t\treturn day;\r\n\t\t} else {\r\n\t\t\treturn day + ' ' + hour + ':' + second;\r\n\t\t}\r\n\t}\r\n\tconsole.log(props, 'props')\r\n\twatch(props.timestamp, (nd) => {\r\n\t\ttimestampChange(nd)\r\n\t}, { immediate: true })\r\n</script>\r\n\r\n<style>\r\n\t@import './dtPicker.css';\r\n</style>","import Component from 'D:/pro/unipro/uniapp_study/components/dtPicker/dtPicker.vue'\nwx.createComponent(Component)"],"names":["ref","onBeforeMount","toRaw","uni","watch","Component"],"mappings":"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"}